<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°¨ëŸ‰ ë“±ë¡ ë° ì§„í–‰ìƒí™© ë³€ê²½ (ê´€ë¦¬ììš©)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .info {
            text-align: left;
            margin: 20px auto;
            width: 60%;
        }
        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: center;
        }
        th {
            background: #f4f4f4;
        }
    </style>
</head>
<body>

    <h1>ğŸš— ì°¨ëŸ‰ ë“±ë¡ ë° ì§„í–‰ìƒí™© ë³€ê²½ (ê´€ë¦¬ììš©)</h1>

    <div class="info">
        <label for="newCarNumber">ğŸ“‹ ì°¨ëŸ‰ë²ˆí˜¸:</label>
        <input type="text" id="newCarNumber" placeholder="ì˜ˆ: 78ë‹¤1234">
        <label for="newModel">ğŸš— ëª¨ë¸ëª…:</label>
        <select id="newModel">
            <option value="MODEL3">MODEL3</option>
            <option value="MODELY">MODELY</option>
            <option value="MODELS">MODELS</option>
            <option value="MODELX">MODELX</option>
        </select>
        <label for="expectedDate">ğŸ“… ì¶œê³  ì˜ˆì •ì¼:</label>
        <input type="date" id="expectedDate">
        <button onclick="registerCar()">ë“±ë¡</button>
    </div>

    <h2>ğŸš˜ ë“±ë¡ëœ ì°¨ëŸ‰ ëª©ë¡ ë° ì§„í–‰ìƒí™© ë³€ê²½</h2>
    <table>
        <tr>
            <th>ì°¨ëŸ‰ë²ˆí˜¸</th>
            <th>ëª¨ë¸ëª…</th>
            <th>ì¶œê³  ì˜ˆì •ì¼</th>
            <th>ì§„í–‰ìƒí™©</th>
            <th>ìƒíƒœ ë³€ê²½</th>
            <th>ì •ë¹„ ë‚´ì—­</th>
        </tr>
        <tbody id="carTable">
            <!-- ë“±ë¡ëœ ì°¨ëŸ‰ ëª©ë¡ í‘œì‹œ -->
        </tbody>
    </table>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let carData = JSON.parse(localStorage.getItem("carData")) || {};

            function registerCar() {
                const newCarNumber = document.getElementById("newCarNumber").value;
                const newModel = document.getElementById("newModel").value;
                const expectedDate = document.getElementById("expectedDate").value;

                if (!newCarNumber) {
                    alert("ì°¨ëŸ‰ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”!");
                    return;
                }

                if (carData[newCarNumber]) {
                    alert("ì´ë¯¸ ë“±ë¡ëœ ì°¨ëŸ‰ì…ë‹ˆë‹¤.");
                    return;
                }

                carData[newCarNumber] = {
                    "ëª¨ë¸ëª…": newModel,
                    "ì§„í–‰ìƒíƒœ": "ì…ê³ ",
                    "ì¶œê³ ì˜ˆì •ì¼": expectedDate ? expectedDate : "ë¯¸ì •",
                    "ì •ë¹„ë‚´ì—­": [[new Date().toISOString().slice(0, 10), "ì…ê³ "]]
                };

                localStorage.setItem("carData", JSON.stringify(carData));
                alert("ğŸš— ì°¨ëŸ‰ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!");

                displayCarTable();
            }

            function displayCarTable() {
                const carTable = document.getElementById("carTable");
                carTable.innerHTML = "";

                for (const carNumber in carData) {
                    const car = carData[carNumber];

                    const row = `
                        <tr>
                            <td>${carNumber}</td>
                            <td>${car.ëª¨ë¸ëª…}</td>
                            <td>
                                <input type="date" id="expected-${carNumber}" value="${car.ì¶œê³ ì˜ˆì •ì¼ !== 'ë¯¸ì •' ? car.ì¶œê³ ì˜ˆì •ì¼ : ''}"
                                       onchange="updateExpectedDate('${carNumber}')">
                            </td>
                            <td id="status-${carNumber}">${car.ì§„í–‰ìƒíƒœ}</td>
                            <td>
                                <select onchange="updateStatus('${carNumber}', this.value)">
                                    <option value="ì…ê³ " ${car.ì§„í–‰ìƒíƒœ === "ì…ê³ " ? "selected" : ""}>ì…ê³ </option>
                                    <option value="ë¶€ì†ëŒ€ê¸°" ${car.ì§„í–‰ìƒíƒœ === "ë¶€ì†ëŒ€ê¸°" ? "selected" : ""}>ë¶€ì†ëŒ€ê¸°</option>
                                    <option value="ìˆ˜ë¦¬ì¤‘" ${car.ì§„í–‰ìƒíƒœ === "ìˆ˜ë¦¬ì¤‘" ? "selected" : ""}>ìˆ˜ë¦¬ì¤‘</option>
                                    <option value="ìˆ˜ë¦¬ì™„ë£Œ" ${car.ì§„í–‰ìƒíƒœ === "ìˆ˜ë¦¬ì™„ë£Œ" ? "selected" : ""}>ìˆ˜ë¦¬ì™„ë£Œ</option>
                                    <option value="ì¶œê³ ì¤€ë¹„" ${car.ì§„í–‰ìƒíƒœ === "ì¶œê³ ì¤€ë¹„" ? "selected" : ""}>ì¶œê³ ì¤€ë¹„</option>
                                    <option value="ì¶œê³ ë¨" ${car.ì§„í–‰ìƒíƒœ === "ì¶œê³ ë¨" ? "selected" : ""}>ì¶œê³ ë¨</option>
                                </select>
                            </td>
                            <td>
                                <button onclick="viewLog('${carNumber}')">ì •ë¹„ ë‚´ì—­</button>
                            </td>
                        </tr>
                    `;
                    carTable.innerHTML += row;
                }
            }

            function updateStatus(carNumber, newStatus) {
                carData[carNumber].ì§„í–‰ìƒíƒœ = newStatus;
                carData[carNumber].ì •ë¹„ë‚´ì—­.push([new Date().toISOString().slice(0, 10), newStatus]);

                localStorage.setItem("carData", JSON.stringify(carData));
                document.getElementById(`status-${carNumber}`).textContent = newStatus;
            }

            function updateExpectedDate(carNumber) {
                const newDate = document.getElementById(`expected-${carNumber}`).value;
                carData[carNumber].ì¶œê³ ì˜ˆì •ì¼ = newDate ? newDate : "ë¯¸ì •";

                localStorage.setItem("carData", JSON.stringify(carData));
                alert("ğŸ“… ì¶œê³  ì˜ˆì •ì¼ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!");
            }

            window.viewLog = function(carNumber) {
                const logData = carData[carNumber].ì •ë¹„ë‚´ì—­;
                let logMessage = `ğŸš— ì°¨ëŸ‰ë²ˆí˜¸: ${carNumber}\nğŸ“œ ì •ë¹„ ë‚´ì—­:\n`;
                logData.forEach(entry => {
                    logMessage += `${entry[0]} - ${entry[1]}\n`;
                });
                alert(logMessage);
            };

            window.registerCar = registerCar;
            window.updateStatus = updateStatus;
            window.updateExpectedDate = updateExpectedDate;
            displayCarTable();
        });
    </script>

</body>
</html>
